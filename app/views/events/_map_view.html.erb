<script src='http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAQG5gwtCYnFF_zNfaIQ6dFRS6yI4Oky2btJnizjKkhx0I2b61jBS0hmTmzLwP23OIzX7R3J3sUvuFYA' type='text/javascript'></script>

<script src="http://gmaps-utility-library.googlecode.com/svn/trunk/markermanager/release/src/markermanager.js"></script>
<div id="events_map" style="height:600px">
  
</div>
<script type="text/javascript">
/* <![CDATA[ */

var events_map;

function initialize_google_map_events_map() {
  if(GBrowserIsCompatible()) {
    events_map = new GMap2(document.getElementById('events_map'));
    
    if (self['GoogleMapOnLoad']) {
      events_map.load = GEvent.addListener(events_map,'load',GoogleMapOnLoad)
    }

    events_map.addControl(new GSmallZoomControl());
    events_map.addControl(new GMapTypeControl());
    events_map.enableDoubleClickZoom();
    events_map.disableContinuousZoom();
    events_map.disableScrollWheelZoom();

    var events_map_latlng_bounds = new GLatLngBounds();
    events_map_latlng_bounds.extend(new GLatLng(<%= @start_lat %>,<%= @start_lng %>));
    events_map.setCenter(events_map_latlng_bounds.getCenter(), <%= @start_zoom %>);
    
    marker_manager = new MarkerManager(events_map);
    <% @venues.each do |venue| %>
      var marker = new GMarker(new GLatLng(<%= venue.lat %>, <%= venue.lng %>));
      marker_manager.addMarker(marker, 1);
    <% end %>
    
  }
}
if (typeof window.onload != 'function') {
  window.onload = initialize_google_map_events_map;
} else {
  old_before_google_map_events_map = window.onload;
  window.onload = function() {
    old_before_google_map_events_map();
    initialize_google_map_events_map();
  }
}
/* ]]> */</script>